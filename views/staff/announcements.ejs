<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .islamic-header {
            background: linear-gradient(135deg, #1a5f3f, #2d7a5f);
            color: white;
            padding: 2rem 0;
        }
        .announcement-card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .announcement-card:hover {
            transform: translateY(-2px);
        }
        .priority-high {
            border-left: 5px solid #dc3545;
        }
        .priority-normal {
            border-left: 5px solid #ffc107;
        }
        .priority-low {
            border-left: 5px solid #28a745;
        }
        .announcement-meta {
            font-size: 0.875rem;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <%- include('../layout/header') %>

    <div class="islamic-header">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <h1 class="text-center mb-0">
                        <i class="fas fa-bullhorn me-2"></i>
                        Announcements
                    </h1>
                    <p class="text-center mt-2 mb-0">Create and manage school announcements</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <!-- Create New Announcement Button -->
        <div class="row mb-4">
            <div class="col-12">
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createAnnouncementModal">
                    <i class="fas fa-plus me-2"></i>
                    Create New Announcement
                </button>
            </div>
        </div>

        <!-- Statistics -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card text-white bg-primary">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="card-title">Total Announcements</h5>
                                <h2 class="mb-0">12</h2>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-bullhorn fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-success">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="card-title">Active</h5>
                                <h2 class="mb-0">8</h2>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-check-circle fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-warning">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="card-title">Draft</h5>
                                <h2 class="mb-0">3</h2>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-edit fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-white bg-danger">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <div>
                                <h5 class="card-title">Expired</h5>
                                <h2 class="mb-0">1</h2>
                            </div>
                            <div class="align-self-center">
                                <i class="fas fa-clock fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Announcements List -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-list me-2"></i>
                            Recent Announcements
                        </h5>
                    </div>
                    <div class="card-body">
                        <!-- Sample Announcements -->
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card announcement-card priority-high">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fas fa-exclamation-triangle text-danger me-2"></i>
                                            New Academic Session Begins
                                        </h6>
                                        <span class="badge bg-danger">High Priority</span>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text">
                                            We are pleased to announce that the new academic session will begin on January 15, 2024. 
                                            All students are expected to resume on the specified date with their necessary materials.
                                        </p>
                                        <div class="announcement-meta">
                                            <i class="fas fa-calendar me-1"></i>
                                            Created: Dec 20, 2023
                                            <span class="mx-2">|</span>
                                            <i class="fas fa-eye me-1"></i>
                                            Views: 245
                                        </div>
                                        <div class="mt-3">
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editAnnouncement('1')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn btn-outline-success" onclick="toggleStatus('1')">
                                                    <i class="fas fa-check"></i> Publish
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="deleteAnnouncement('1')">
                                                    <i class="fas fa-trash"></i> Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <div class="card announcement-card priority-normal">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fas fa-info-circle text-warning me-2"></i>
                                            Parent-Teacher Meeting
                                        </h6>
                                        <span class="badge bg-warning">Normal</span>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text">
                                            A parent-teacher meeting has been scheduled for January 10, 2024, at 2:00 PM. 
                                            All parents are invited to attend and discuss their child's progress.
                                        </p>
                                        <div class="announcement-meta">
                                            <i class="fas fa-calendar me-1"></i>
                                            Created: Dec 18, 2023
                                            <span class="mx-2">|</span>
                                            <i class="fas fa-eye me-1"></i>
                                            Views: 189
                                        </div>
                                        <div class="mt-3">
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editAnnouncement('2')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn btn-outline-warning" onclick="toggleStatus('2')">
                                                    <i class="fas fa-pause"></i> Draft
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="deleteAnnouncement('2')">
                                                    <i class="fas fa-trash"></i> Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <div class="card announcement-card priority-low">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fas fa-book text-success me-2"></i>
                                            Library Hours Update
                                        </h6>
                                        <span class="badge bg-success">Low Priority</span>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text">
                                            The school library will be open from 8:00 AM to 5:00 PM on weekdays. 
                                            Students can access textbooks, reference materials, and digital resources.
                                        </p>
                                        <div class="announcement-meta">
                                            <i class="fas fa-calendar me-1"></i>
                                            Created: Dec 15, 2023
                                            <span class="mx-2">|</span>
                                            <i class="fas fa-eye me-1"></i>
                                            Views: 156
                                        </div>
                                        <div class="mt-3">
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editAnnouncement('3')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn btn-outline-success" onclick="toggleStatus('3')">
                                                    <i class="fas fa-check"></i> Publish
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="deleteAnnouncement('3')">
                                                    <i class="fas fa-trash"></i> Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <div class="card announcement-card priority-normal">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <h6 class="mb-0">
                                            <i class="fas fa-graduation-cap text-info me-2"></i>
                                            Scholarship Applications
                                        </h6>
                                        <span class="badge bg-warning">Normal</span>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text">
                                            Applications for merit-based scholarships are now open. 
                                            Interested students should submit their applications by January 5, 2024.
                                        </p>
                                        <div class="announcement-meta">
                                            <i class="fas fa-calendar me-1"></i>
                                            Created: Dec 12, 2023
                                            <span class="mx-2">|</span>
                                            <i class="fas fa-eye me-1"></i>
                                            Views: 203
                                        </div>
                                        <div class="mt-3">
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary" onclick="editAnnouncement('4')">
                                                    <i class="fas fa-edit"></i> Edit
                                                </button>
                                                <button class="btn btn-outline-success" onclick="toggleStatus('4')">
                                                    <i class="fas fa-check"></i> Publish
                                                </button>
                                                <button class="btn btn-outline-danger" onclick="deleteAnnouncement('4')">
                                                    <i class="fas fa-trash"></i> Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Empty State (if no announcements) -->
                        <div class="text-center py-5" id="emptyState" style="display: none;">
                            <i class="fas fa-bullhorn fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">No announcements yet</h5>
                            <p class="text-muted">Create your first announcement to get started.</p>
                            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createAnnouncementModal">
                                <i class="fas fa-plus me-2"></i>
                                Create Announcement
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Announcement Modal -->
    <div class="modal fade" id="createAnnouncementModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>
                        Create New Announcement
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="announcementForm">
                        <div class="mb-3">
                            <label for="announcementTitle" class="form-label">
                                <i class="fas fa-heading me-1"></i>
                                Title
                            </label>
                            <input type="text" class="form-control" id="announcementTitle" name="title" 
                                   placeholder="Enter announcement title" required>
                        </div>

                        <div class="mb-3">
                            <label for="announcementContent" class="form-label">
                                <i class="fas fa-align-left me-1"></i>
                                Content
                            </label>
                            <textarea class="form-control" id="announcementContent" name="content" 
                                     rows="5" placeholder="Enter announcement content" required></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="announcementPriority" class="form-label">
                                        <i class="fas fa-flag me-1"></i>
                                        Priority
                                    </label>
                                    <select class="form-select" id="announcementPriority" name="priority" required>
                                        <option value="">Select priority</option>
                                        <option value="high">High Priority</option>
                                        <option value="normal">Normal Priority</option>
                                        <option value="low">Low Priority</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="announcementStatus" class="form-label">
                                        <i class="fas fa-toggle-on me-1"></i>
                                        Status
                                    </label>
                                    <select class="form-select" id="announcementStatus" name="status" required>
                                        <option value="draft">Draft</option>
                                        <option value="published">Publish Now</option>
                                        <option value="scheduled">Schedule for Later</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="announcementExpiry" class="form-label">
                                        <i class="fas fa-calendar-times me-1"></i>
                                        Expiry Date (Optional)
                                    </label>
                                    <input type="date" class="form-control" id="announcementExpiry" name="expiry_date">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="announcementTarget" class="form-label">
                                        <i class="fas fa-users me-1"></i>
                                        Target Audience
                                    </label>
                                    <select class="form-select" id="announcementTarget" name="target_audience" required>
                                        <option value="">Select audience</option>
                                        <option value="all">All Students</option>
                                        <option value="parents">Parents Only</option>
                                        <option value="staff">Staff Only</option>
                                        <option value="senior">Senior Students</option>
                                        <option value="junior">Junior Students</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>
                        Cancel
                    </button>
                    <button type="button" class="btn btn-outline-primary" id="saveDraftBtn">
                        <i class="fas fa-save me-1"></i>
                        Save as Draft
                    </button>
                    <button type="button" class="btn btn-success" id="publishBtn">
                        <i class="fas fa-paper-plane me-1"></i>
                        Publish Now
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Form submission handlers
        document.getElementById('publishBtn').addEventListener('click', function() {
            const form = document.getElementById('announcementForm');
            if (form.checkValidity()) {
                // Simulate publishing announcement
                alert('Announcement published successfully!');
                $('#createAnnouncementModal').modal('hide');
                form.reset();
            } else {
                form.reportValidity();
            }
        });

        document.getElementById('saveDraftBtn').addEventListener('click', function() {
            const form = document.getElementById('announcementForm');
            if (form.checkValidity()) {
                // Simulate saving as draft
                alert('Announcement saved as draft!');
                $('#createAnnouncementModal').modal('hide');
                form.reset();
            } else {
                form.reportValidity();
            }
        });

        // Action functions
